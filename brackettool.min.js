async function brackettool(e,t,r,n,i,s,l){function a(){function e(t,n){return new Promise((i,s)=>{if("string"==typeof t||t instanceof String)r.push({id:n,brackets:t}),i();else if(Array.isArray(t)){let r=[];for(let i in t)r.push(e(t[i],n.concat(i)));Promise.all(r).then(()=>{i()})}else s(u.invalidBrackets)})}let r=[];return new Promise((n,i)=>{e(t,[]).then(()=>{if(r.length%2==0){let e=[];for(let t in r)for(let n in r[t].id)void 0===e[n]&&(e[n]=0),e[n]=Math.max(e[n],r[t].id[n].toString().length);e=e.map(e=>e.toString().length);for(let t in r){for(let n in r[t].id){let i=`${"0".repeat(e[n])}${r[t].id[n]}`;r[t].id[n]=i.substring(i.length-e[n],i.length)}r[t].upper=r[t].id.slice(0,r[t].id.length-1)}r.sort((e,t)=>e.id.join("")-t.id.join("")).map(e=>[e.brackets,e.upper]);let t=[];for(let e=0;e<r.length/2;e++)r[2*e].upper.join("")!==r[2*e+1].upper.join("")&&i(u.oddBrackets),t[e]=[r[2*e].brackets,r[2*e+1].brackets];n(t)}else i(u.oddBrackets)}).catch(e=>{i(e)})})}function o(t){function a(e,r){return r?new RegExp(`${c(t[e][0])}([\\s\\S]*?)${c(t[e][1])}`,"g"):new RegExp(`[\\s\\S]{0,${s}}${c(t[e][0])}[\\s\\S]*?${c(t[e][1])}[\\s\\S]{0,${l}}`,"g")}function o(e){return/delete(?!-together)|erase|remove/.test(r)?"$1":/delete-together/.test(r)?(console.log(0),""):/brackets?/.test(r)?`<span class="brackets brackets-before brackets-${e}">${t[e][0]}</span>$1<span class="brackets brackets-after brackets-${e}">${t[e][1]}</span>`:/contents?/.test(r)?`<span class="brackets brackets-${e}">$1</span>`:(console.error(u.invalidProcType),!1)}let p=e;if(void 0===n||""===n||/all|hole/.test(n)){for(let e in t)p=p.replace(a(e,!0),o(e));return p}if(!/parts?|pickout|pickup/.test(n))return console.error(u.invalidSelectMode),!1;for(let r in t)a(r,!0).test(e)&&(p=(e.match(a(r,!1))||[""]).map(e=>e.replace(a(r,!0),o(r)).replace(/[\r\n]/g,"")));if(/array|row/.test(i))return p;if(void 0!==i&&""!==i&&!/list|ul|ol/.test(i))return console.log(u.invalidOutputType),!1;{let e="";for(let t in p)e+=`<li>${p[t]}</li>\n`;switch(i){case/list|ul/:return`<ul>\n${e}</ul>\n`;case"ol":return`<ol>\n${e}</ol>\n`;default:return`<ul>\n${e}</ul>\n`}}}function c(e){function t(e){return e.replace(/(\/|\\|\^|\$|\*|\+|\?|\.|\(|\)|\[|\]|\{|\})/g,"\\$1")}return"string"==typeof e||e instanceof String?t(e):Array.isArray(e)?e.map(e=>e=t(e)):e}let u={oddBrackets:"括弧の指定が奇数です。",invalidBrackets:"引数 brackets の値の型が無効です。",invalidSelectMode:"引数 selectMode の値が無効です。",invalidProcType:"引数 procType の値が無効です。",mismatchBrackets:"一致しない brackets があります。",invalidOutputType:"引数 outputType の値が無効です"};return a().then(e=>o(e))}